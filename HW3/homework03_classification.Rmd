---
title: "Home Work Assignment - 03"
author: "Critical Thinking Group 5"
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
---

\newpage

# Overview 
  
To attain our objective, we will be following the below best practice steps and guidelines: \

1 -Data Exploration \
2 -Data Preparation \
3 -Build Models \
4 -Select Models \



```{r, echo = FALSE, warning=FALSE, message=FALSE}
if (!require("ggplot2",character.only = TRUE)) (install.packages("ggplot2",dep=TRUE))
if (!require("MASS",character.only = TRUE)) (install.packages("MASS",dep=TRUE))
if (!require("knitr",character.only = TRUE)) (install.packages("knitr",dep=TRUE))
if (!require("xtable",character.only = TRUE)) (install.packages("xtable",dep=TRUE))
if (!require("dplyr",character.only = TRUE)) (install.packages("dplyr",dep=TRUE))
if (!require("psych",character.only = TRUE)) (install.packages("psych",dep=TRUE))
if (!require("stringr",character.only = TRUE)) (install.packages("stringr",dep=TRUE))
if (!require("car",character.only = TRUE)) (install.packages("car",dep=TRUE))
if (!require("faraway",character.only = TRUE)) (install.packages("faraway",dep=TRUE))

library(ggplot2)
library(MASS)
library(knitr)
library(xtable)
library(dplyr)
library(psych)
library(stringr)
library(car)
library(faraway)

city_crime_train <- read.csv("https://raw.githubusercontent.com/kishkp/data621-ctg5/master/HW3/crime-training-data.csv")

str(city_crime_train)

summary(city_crime_train)


city_crime_test <- read.csv("https://raw.githubusercontent.com/kishkp/data621-ctg5/master/HW3/crime-evaluation-data.csv")

str(city_crime_test)


```
#1 Data Exploration Analysis

In section we will explore and gain some insights into the dataset by pursuing the below high level steps and inquiries: \
-Variable identification \
-Variable Relationships \
-Data summary analysis \
-Outliers and Missing Values Identification

##1.1	Variable identification

First let's display and examine the data dictionary or the data columns as shown in table 1. \


```{r, echo = FALSE, warning=FALSE, message=FALSE}


kable(summary(city_crime_train))

```
\
\




\



\newpage

##1.2 Data Summary Analysis


In this section, we will create summary data to better understand the initial relationship variables have with our dependent variable using correlation, central tendency, and dispersion As shown in table 2.  



```{r, echo = FALSE, warning=FALSE, message=FALSE}
ds_stats <- psych::describe(city_crime_train, skew = TRUE, na.rm = TRUE)



x<-colnames(city_crime_train)
fun <- function(x) sum(!complete.cases(x))
Missing <- sapply(city_crime_train[x], FUN = fun) 

#ds_stats <- cbind(ds_stats, Missing)


# fun <- function(x) mean(x, na.rm=T)
# Mean <- sapply(moneyball2[Variable], FUN = fun) 

fun <- function(x, y) cor(y, x)
Correlation <- sapply(city_crime_train[x], FUN = fun, y=city_crime_train$target) 


kable(data.frame(Correlation), caption = "Correlation between target and predictor variable")
```


##1.3	Outliers and Missing Values Identification


In this section we look at boxplots to determine the outliers in variables and decide on whether to act on the outliers. 


Lets do some univariate analysis. We will look at the Histogram and Boxplot for each variable to detect outliers if any and treat it accordingly.

```{r, echo = FALSE, warning=FALSE, message=FALSE}
show_charts <- function(x, ...) {
    
    par(mfrow=c(2,3))
    
    xlabel <- unlist(str_split(deparse(substitute(x)), pattern = "\\$"))[2]
#    ylabel <- unlist(str_split(deparse(substitute(y)), pattern = "\\$"))[2]
    
    hist(x,main=xlabel)
    boxplot(x,main=xlabel)

    y<-log(x)
    boxplot(y,main='log transform')
    y<-sqrt(x)
    boxplot(y,main='sqrt transform')
    y<-sin(x)
    boxplot(y,main='sin transform')
    y<-(x)^(1/9)
    boxplot(y,main='ninth transform')
}

attach(city_crime_train)

```

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.cap='zn Transformation'}
show_charts(city_crime_train$zn)


table(zn)

```
For ZN, we can see that there are large number of values with 0. 

\newpage
***Please note that we have created similar figures to figure 1 above for each remaining variable. 
However, we hid the remaining figures for ease of streamlining the report as they have similar shapes. However, we have drawn the below observations from each remaining figure. \



```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(indus)
table(indus)
summary(indus)
hist(sqrt(indus))


```

For indus, we can see that there is a spike toward right side of he distribution. Looking at the sqrt transformation it appears that distribution is close to normal and having two peaks after transformation.  
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}


show_charts(nox)
summary(nox)

```

\
For nox, there is a long right tail.

\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(rm)
summary(rm)

```

\
For rm, there are some outliers as we can see from box plot.
\

```{r, echo = FALSE, warning=FALSE, message=FALSE,fig.show ='hide'}

show_charts(age)
```

age of the building variable is skewed heavily towards right side. We will need some transformation for this variable and looks sin transformation is best option for this case  
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(dis)

```

For this variable dis, there are some outliers which needs transformation to handle those outliers. Sin transformation looks best suited for this scenario.
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(rad)
table(rad)

```

For rad variable distribution is not uniform as seen from the chart and will need transformation.

\
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(tax)

table(tax)

```

For tax variable is not uniformly distributed but there is no outlier for this variable.
\
\


\
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(ptratio)

```

For pratio has right aligned peak but no outliers are there in data set.
\
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(black)

```


\
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(lstat)

```
The variable lstat has long right tail and lef skewed

\
\

```{r, echo = FALSE, warning=FALSE, message=FALSE, fig.show ='hide'}

show_charts(medv)

```

The variable medv has close to normal distribution and lot of outliers towers uppper end. Looks like sin transformation is requried in this scenario.




